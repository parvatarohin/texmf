% !TeX TS-program = xelatex
% !TeX builder = latexmk

%% XeLaTeX stuff:
%% Normalize any residual Unicode combining accents and write out error messages
\XeTeXinputnormalization=1
\tracinglostchars=1
\tracingonline=1
\XeTeXgenerateactualtext=1

%% Don't modify the `\DocumentMetadata` command unless you know what it does!
%% If this command throws an "undefined" error, your LaTeX system is out of date.
\DocumentMetadata{
	pdfstandard = a-2b,
	pdfversion  = 1.7,
	lang		    = en-US
}

\documentclass[a4paper,oneside,12pt]{article}
\usepackage[nomarginpar]{geometry}
\usepackage{metalogo}

\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 4pt}
\setlength{\emergencystretch}{3em}
\frenchspacing

\clubpenalty=9996
\widowpenalty=9999
\brokenpenalty=4991

\predisplaypenalty=10000
\postdisplaypenalty=1549
\displaywidowpenalty=1602

\interfootnotelinepenalty 10
\vfuzz2pt
\hfuzz2pt

\usepackage{polyglossia}
\setmainlanguage{english}
\setotherlanguage{sanskrit}

\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily]{Ligatures=TeX}
\setmainfont[Numbers=Lining,Scale=MatchLowercase]{Brill}

\newcommand\sa{\catcode`\^=11\catcode`\~=11%
              \fontspec[Script=Devanagari,Mapping=itrans-dn,Scale=MatchLowercase]{Shobhika}}

\title{\XeTeX\ Font Mapping}
\author{ITRANS to Devanāgarī transliteration}
\date{\relax}

\begin{document}

\maketitle
\thispagestyle{empty}
\bigskip

\begin{verse}
  {\sa shrI jAniradritanayApatirab.hjagarbhaH\\
    sarve cha daivatagaNAH samaharShayo.amI |\\
    ete bhUtanichayAH samudIrayanti\\
    gAyatri \- lokavinute tava suprabhAtam || 1 ||

    puShpochchayapravilasatkaraka.njayugmAm\\
    ga.ngAdidivyataTinIvaratIradeshe\- |\\
    Shvarghyam samarpayitumatrajanAstavaite\\
    gAyatri \- lokavinute \- tava suprabhAtam || 2 ||

    karNe.amR^itam vikiratA svarasa.nchayena\\
    sarve dvijAH shrutigaNam samudIrayanti |\\
    pashyAshramAsatha vR^ikShataleShu devi\\
    gAyati \-lokavinute \-tava suprabhAtam || 3 ||
  }
\end{verse}

\end{document}
